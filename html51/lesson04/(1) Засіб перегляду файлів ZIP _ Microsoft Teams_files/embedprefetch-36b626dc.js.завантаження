define("odsp-next/dataSources/item/vroom/EmbedPrefetch",["require","exports","./EmbedPrefetchInternal"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.config=r.getConfig();try{r.prefetch(t.config)}catch(e){var n=t.config.results;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];a.data=void 0;a.status=400}console.error("prefetch error: ",e)}});define("odsp-next/dataSources/item/vroom/EmbedPrefetchInternal",["require","exports","tslib","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/sp-resource-path","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/navigation/AddressParser","@ms/utilities-jwt/lib/claims","../../../utilities/appId/KnownIds","../../../utilities/images/ImagePreloader","./EmbedResponseTranslator","./Fetch"],function(e,t,w,L,W,k,U,I,z,V,O,H,G){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function P(e){return"boolean"==typeof e?e:"number"==typeof e?0!==e:!!e&&"false"!==e.toLowerCase()&&"0"!==e}function T(e){return e&&e.split(".").pop().toLowerCase()||""}t.getConfig=function(e){void 0===e&&(e=window);var t=I.deserializeQuery((e.location.search||"").slice(1)),r=I.deserializeQuery((e.location.hash||"").slice(1)),n=e.PageContext,o=n&&n.scenarioContext.embed||{},a=w.__assign({},t,r,o);a.id&&0===a.id.lastIndexOf("%2F",0)&&(a.id=decodeURIComponent(a.id));var i=e.Flight;i&&!i.Ramps&&(i.Ramps=i.ramps);var s=o.item,l=e._spPageContextInfo,c=l&&l.authToken||a.authToken||a.access_token,p=z.parseTokenPayload(c),u=p&&p.app_displayname||a.client_id,d=a.correlationId||l&&l.CorrelationId,f={eventData:{clientId:u,CorrelationId:d},viewer:a.viewer},m={hideDownload:P(o.hideDownload),showNewWindow:!("showNewWindow"in a)&&"FileViewerWebPart"===u||P(a.showNewWindow),useHostDownload:P(o.useHostDownload)};try{var v=a.embed;f.options="string"==typeof v?JSON.parse(v):v}catch(e){}var b=l?w.__assign({},l,{authToken:c,CorrelationId:d}):{authToken:c,CorrelationId:d,webAbsoluteUrl:function(e,t){var r=e&&e.sharepointIds,n=r&&r.siteUrl||t.webUrl;return n&&n.replace(/\/+$/,"")}(s,a),layoutsUrl:"_layouts/15",currentUICultureName:a.culture||n&&n.mkt,env:n&&n.env,isSPO:!0};l&&(e.PageContext={env:l.env||"edog",farmLabel:l.farmLabel,isAuthenticated:!!l.userEmail||!!c,mkt:a.culture||l.currentUICultureName,scenarioContext:{embed:void 0},siteSubscriptionId:l.siteSubscriptionId,userName:l.userLoginName});e._spPageContextInfo=b;var h=a.id,x=a.extension,_=function(e,t){var r=e&&e.sharepointIds,n=r&&r.listItemUniqueId||t.UniqueId;if(n)return n;var o=t.resId;return o&&32===o.length?o.slice(0,8)+"-"+o.slice(8,12)+"-"+o.slice(12,16)+"-"+o.slice(16,20)+"-"+o.slice(20):o}(s,a);a.uniqueId=_;var g=T(x||s&&s.name||h),y=g&&k.getIconNameFromExtension(g);return{appMap:y&&"pdf"!==y?U.OfficeIconFileTypeMap[y]:void 0,claims:p,context:o,embedParams:f,iconName:y,isClientFormat:!!{pdf:1,ai:1,glb:1,gltf:1}[g],pageContext:b,params:a,viewerContext:m,results:{item:G.createPrefetchResult(),openWithWac:G.createPrefetchResult(),webApplicationUrls:G.createPrefetchResult(),wopiToken:G.createPrefetchResult()},isMicroService:!l}};function Q(e,t){e.status=t;e.callback&&e.callback(t)}function $(b,h){var e=b.params,x=e.uniqueId,_=e.wopiToken,g=b.pageContext,t=b.results,y=t.item,w=t.openWithWac,P=t.webApplicationUrls,S=t.wopiToken,r=function(){var e=h.g_fileInfo,t=e&&I.deserializeQuery((e.downloadUrl||"").split("?")[1]),r=x||t&&t.UniqueId,n=H.translateFileInfo(e,h.g_deferDataStatus,g,r),o=n.status;y.data=n.response;Q(y,o);var a=e&&e.wopiToken||_;S.data=a;Q(S,a?200:204);var i=h.g_webApplicationUrls,s=i?200:204;i&&(P.data={d:{GetWebApplicationUrls:{results:i}}});Q(P,s);var l=T(e&&e.name),c=l&&k.getIconNameFromExtension(l),p=c&&"pdf"!==c?U.OfficeIconFileTypeMap[c]:void 0,u="ms-word"===p||"ms-powerpoint"===p,d=e&&e[".transformUrl"];if(d&&"ms-word"===p){var f="edog"===g.env,m=d.replace(/[&?](width|height)=[^&]*/g,"").replace("https://media.cloudapp.net",f?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms").replace("transform/thumbnail?","transform/OfficeBundleFragment?")+"&fragment=p1.img";O.preloadImage(m)}if(u&&a&&r)!function(e,t,r,n){var o=z.parseTokenPayload(t),a=e.results.openWithWac,i=e.pageContext;if(o&&"PreAuthToken"!==o.wopi_tt){var s=L.default.escapeUrlForCallback(i.webAbsoluteUrl),l={accessToken:t,accessTokenExpiry:o.exp+"000",wopiSrc:function(e,t){return e+"/_vti_bin/wopi.ashx/files/"+(t&&t.replace(/[^\dA-Fa-f]+/g,""))}(s,r)};a.data=l;Q(a,200);return}var c=n.replace(/\/_layouts\/[^?]+/i,"/_layouts/15/WopiEmbedFrame.aspx").replace(/action=[^&]+/,"action=embedview&wdnc=1&nobg=1").replace("&mobileredirect=true","&mobileredirect=false");G.prefetchUrl({url:c,headers:{"Content-Type":"application/x-www-form-urlencoded"},postdata:"access_token="+t,prefetchResult:a,parseResponse:function(e,t){var r=e.indexOf("<form"),n=e.indexOf("</form>",r)+7,o=e.substring(r,n);try{var a=new DOMParser,i=a.parseFromString(o,"text/html"),s=i.getElementsByTagName("form")[0].action,l=i.querySelector('[name="access_token"]').value,c=i.querySelector('[name="access_token_ttl"]').value,p=I.deserializeQuery(s.split("?")[1]),u={accessToken:l,accessTokenExpiry:""+c,applicationUrl:s,wopiSrc:p.wopiSrc};return{response:u,status:200}}catch(e){return{response:void 0,status:500}}}})}(b,a,r,e.webUrl);else if(u){var v=e&&e[".spItemUrl"];v?X(b,v):Q(w,400)}else Q(w,204)};"number"==typeof h.g_deferDataStatus?r():h.OnLoadFileInfo=r}function J(e){var t=e.pageContext.webAbsoluteUrl,r=e.params,n=r.id,o=r.item,a=r.uniqueId;if(o){var i=o["@odata.id"];if(i)return i;var s=o.id,l=o.parentReference,c=l&&l.driveId;if(s&&c)return t+"/_api/v2.0/drives/"+c+"/items/"+s}if(a)return t+"/_api/v2.0/sites/root/items/"+a+"/driveItem";if(n){var p=new W.SPResourcePath(n);return t+"/_api/v2.0/shares/"+function(e){return"u!"+btoa(unescape(encodeURIComponent(e))).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_")}(""+(p.authority||new W.SPResourcePath(t).authority)+p.path)+"/driveItem"}}t.getVroomUrl=J;t.prefetch=function(e,t){void 0===t&&(t=window);if(e.isMicroService){var r=e.appMap,n=e.claims,o=e.isClientFormat,a=e.pageContext,i=e.params,s=e.results,l=s.item,c=s.openWithWac,p=s.webApplicationUrls,u=s.wopiToken,d=a.authToken,f=a.webAbsoluteUrl,m=i.id,v=i.item,b=i.viewer,h=i.uniqueId,x=n&&z.getAppId(n),_=z.isHashedProofToken(n),g=x&&!_&&V.isWopiAllowed(x),y=!(b&&"Wrs"!==b||"ms-word"!==r&&"ms-powerpoint"!==r),w=m&&new W.SPResourcePath(m),P=w&&w.path,S=new W.SPResourcePath(f),k=w&&w.authority&&w.authority!==S.authority,U=J(e),I=v&&v.openWith&&v.openWith.wac;if(I){c.data=I;B(e);Q(c,200)}else if(y){B(e);g&&U?X(e,U):Q(c,204)}else{Q(p,204);Q(c,204)}u.data=d;Q(u,200);if(v&&((v["@content.downloadUrl"]||v["@microsoft.graph.downloadUrl"])&&(o||"TextFile"===b)||!y||v.officeBundle||v.listItem)){l.data=v;Q(l,200)}else{var O,T="",R=v&&v.sharepointIds;if(h)O='<FieldRef Name="UniqueId" /><Value Type="Guid">'+h+"</Value>";else if(R)O='<FieldRef Name="ID" /><Value Type="Number">'+R.listItemId+"</Value>";else{if(!P){Q(l,400);console.error("Invalid input to prefetch!");return}O='<FieldRef Name="FileRef" /><Value Type="Text"><![CDATA['+P+"]]></Value>"}R?T=R.listId:P&&(T=function(e){return e&&e.substring(0,e.lastIndexOf("/"))}(m));var j=i.resId||h&&h.replace(/[^A-Fa-f0-9]/g,""),C=T&&T.indexOf("/")<0,F=k||T&&!C&&0!==T.lastIndexOf(S.path,0),M=F&&!k?""+S.authority+T:T,A="'"+L.default.encodeRestUriStringToken(M)+"'",E=F?"SP.List.GetListDataAsStream?listFullUrl="+A+"&":"web/"+(j&&!C?"GetListItemByResourceId('"+j+"')/parentList/RenderListDataAsStream?":(C?"lists/getById(":"GetListUsingPath(DecodedUrl=")+"@a1)/RenderListDataAsStream?@a1="+A+"&"),N=L.default.escapeUrlForCallback(f)+"/_api/"+E+"View=",q={parameters:{__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:546823,ViewXml:'<View Scope="RecursiveAll"><Query><Where><Eq>'+O+'</Eq></Where></Query><RowLimit Paged="TRUE">1</RowLimit></View>'}},D=!z.isTokenValid(n);G.prefetchUrl({authToken:d,url:N,headers:{accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},prefetchResult:l,postdata:JSON.stringify(q),translate:function(e,t){return H.translateRenderList(e,t,a)},isExpired:D})}}else $(e,t)};function B(e){var t=e.context.webApplicationUrls,r=e.results.webApplicationUrls;if(t){r.data=t;Q(r,200)}else{var n=e.pageContext,o=n.authToken,a=n.webAbsoluteUrl,i=L.default.escapeUrlForCallback(a)+"/_api/SP.Utilities.WopiHostUtility.GetWebApplicationUrls(appNames=@a1,actions=@a2)?@a1='Word,PowerPoint,Visio'&@a2='0'";G.prefetchUrl({authToken:o,url:i,headers:{accept:"application/json;odata=verbose"},prefetchResult:r})}}function X(e,t){var r=e.pageContext.authToken,n=t.split("?")[0].replace(/\/v2.1\//g,"/v2.0/")+"/openWith/wac?action=view";G.prefetchUrl({authToken:r,url:n,headers:{accept:"application/json"},prefetchResult:e.results.openWithWac})}});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault;!function(t){var o="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){t(r(o,r(e)))}):"object"==typeof module&&"object"==typeof module.exports?t(r(o,r(module.exports))):t(r(o));function r(r,n){r!==o&&("function"==typeof Object.create?Object.defineProperty(r,"__esModule",{value:!0}):r.__esModule=!0);return function(e,t){return r[e]=n?n(e,t):t}}}(function(e){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};__extends=function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r};__decorate=function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(i=(a<3?o(i):3<a?o(t,r,i):o(t,r))||i);return 3<a&&i&&Object.defineProperty(t,r,i),i};__param=function(r,n){return function(e,t){n(e,t,r)}};__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};__awaiter=function(a,i,s,l){return new(s||(s=Promise))(function(e,t){function r(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((l=l.apply(a,i||[])).next())})};__generator=function(r,n){var o,a,i,e,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(i=2&t[0]?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;(a=0,i)&&(t=[2&t[0],i.value]);switch(t[0]){case 0:case 1:i=t;break;case 4:s.label++;return{value:t[1],done:!1};case 5:s.label++;a=t[1];t=[0];continue;case 7:t=s.ops.pop();s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){s.label=t[1];break}if(6===t[0]&&s.label<i[1]){s.label=i[1];i=t;break}if(i&&s.label<i[2]){s.label=i[2];s.ops.push(t);break}i[2]&&s.ops.pop();s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e];a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};__exportStar=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])};__values=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){e&&r>=e.length&&(e=void 0);return{value:e&&e[r++],done:!e}}}};__read=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i};__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e};__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)};__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,a=r.apply(e,t||[]),i=[];return o={},n("next"),n("throw"),n("return"),o[Symbol.asyncIterator]=function(){return this},o;function n(n){a[n]&&(o[n]=function(r){return new Promise(function(e,t){1<i.push([n,r,e,t])||s(n,r)})})}function s(e,t){try{!function(e){e.value instanceof __await?Promise.resolve(e.value.v).then(l,c):p(i[0][2],e)}(a[e](t))}catch(e){p(i[0][3],e)}}function l(e){s("next",e)}function c(e){s("throw",e)}function p(e,t){(e(t),i.shift(),i.length)&&s(i[0][0],i[0][1])}};__asyncDelegator=function(n){var e,o;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,r){e[t]=n[t]?function(e){return(o=!o)?{value:__await(n[t](e)),done:"return"===t}:r?r(e):e}:r}};__asyncValues=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=o[Symbol.asyncIterator];return t?t.call(o):(o="function"==typeof __values?__values(o):o[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=o[n]&&function(r){return new Promise(function(e,t){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(e,t,(r=o[n](r)).done,r.value)})}}};__makeTemplateObject=function(e,t){Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t;return e};__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);t.default=e;return t};__importDefault=function(e){return e&&e.__esModule?e:{default:e}};e("__extends",__extends);e("__assign",__assign);e("__rest",__rest);e("__decorate",__decorate);e("__param",__param);e("__metadata",__metadata);e("__awaiter",__awaiter);e("__generator",__generator);e("__exportStar",__exportStar);e("__values",__values);e("__read",__read);e("__spread",__spread);e("__await",__await);e("__asyncGenerator",__asyncGenerator);e("__asyncDelegator",__asyncDelegator);e("__asyncValues",__asyncValues);e("__makeTemplateObject",__makeTemplateObject);e("__importStar",__importStar);e("__importDefault",__importDefault)});define("@ms/odsp-utilities/lib/encoding/UriEncoding",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function o(){}o.encodeURIComponent=function(e,t,r,n){var o="",a=0;if(!e)return"";var i=e.length;for(a=0;a<i;a++){var s=e.charCodeAt(a),l=e.charAt(a);if(t&&("#"===l||"?"===l)){o+=e.substr(a);break}if(r&&"&"===l)o+=l;else if(s<=127)n?o+=l:97<=s&&s<=122||65<=s&&s<=90||48<=s&&s<=57||t&&32<=s&&s<=95&&" \"%<>'&".indexOf(l)<0?o+=l:s<=15?o+="%0"+s.toString(16).toUpperCase():s<=127&&(o+="%"+s.toString(16).toUpperCase());else if(s<=2047){o+="%"+(192|s>>6).toString(16).toUpperCase();o+="%"+(128|63&s).toString(16).toUpperCase()}else if(55296!=(64512&s)){o+="%"+(224|s>>12).toString(16).toUpperCase();o+="%"+(128|(4032&s)>>6).toString(16).toUpperCase();o+="%"+(128|63&s).toString(16).toUpperCase()}else if(a<e.length-1){s=(1023&s)<<10;a++;s|=1023&e.charCodeAt(a);o+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase();o+="%"+(128|(258048&s)>>12).toString(16).toUpperCase();o+="%"+(128|(4032&s)>>6).toString(16).toUpperCase();o+="%"+(128|63&s).toString(16).toUpperCase()}}return o};o.escapeUrlForCallback=function(e){var t=e.indexOf("#"),r=e.indexOf("?");if(0<t&&(-1===r||t<r)){var n=e.substr(0,t);0<r&&(n+=e.substr(r));e=n}return o.encodeURIComponent(e,!0,!1,!0)};o.encodeRestUriStringToken=function(e){if(e){e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27");e=o.encodeURIComponent(e)}return e};return o}();t.default=r});define("@ms/sp-resource-path",["./sp-resource-path/lib/index"],function(e){return e});define("@ms/sp-resource-path/lib/index",["require","exports","./SPResourcePath"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPResourcePath=r.SPResourcePath;t.SPResourcePathFormat=r.SPResourcePathFormat});define("@ms/sp-resource-path/lib/SPResourcePath",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.absolute=0]="absolute";e[e.relative=1]="relative";e[e.serverRelative=2]="serverRelative"}(c=t.SPResourcePathFormat||(t.SPResourcePathFormat={}));var r=function(e){void 0===e&&(e="");var t=e.indexOf("//"),r=e.indexOf("/"),n=-1<t&&t<=r?t+"//".length:-1,o=function(e,t){if(-1<t){var r=e.indexOf("/",t);return-1<r?e.slice(0,r):e}return""}(e,n),a=o&&o.slice(n),i=e.slice(o.length),s=o?c.absolute:"/"===i[0]?c.serverRelative:c.relative,l=i.split("/");this.authority=o;this.domain=a;this.format=s;this.path=i;this.segments=l;this.value=e};t.SPResourcePath=r});define("@ms/odsp-utilities/lib/icons/IconSelector",["require","exports","./FileTypeIconMap","./ItemType","../list/SharingTypeHelper"],function(e,t,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s="genericfile";t.genericFile=s;t.codeFile="code";t.videoFile="video";t.photoFile="photo";t.getIconNameFromItem=function(e){var t="";if(e.type===a.default.Folder){t=r.usePrivateFolderIcon(e.sharingType)?"folder":"sharedfolder";e.isDocSet&&(t="docset")}else t=e.type===a.default.OneNote?"one":e.listItem?"splist":"text/typescript"===e.textEditorMimeType?"code":e.panorama?"photo360":l(e.extension);return t};t.getItemTypeFromExtension=function(e){var t;try{if(e){var r=l(e);if(o.default[r]){var n=o.default[r].type;void 0===n&&(n=a.default.File);t=n}}}catch(e){}void 0===t&&(t=a.default.Unknown);return t};function l(e){if(!i){i={};for(var t in o.default){var r=o.default[t].extensions;if(r)for(var n=0;n<r.length;n++)i[r[n]]=t}}e=e.replace(".","").toLowerCase();return i[e]||s}t.getIconNameFromExtension=l});define("@ms/odsp-utilities/lib/icons/FileTypeIconMap",["require","exports","./ItemType"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={accdb:{extensions:["accdb","mdb"]},archive:{type:r.default.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:r.default.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:r.default.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:r.default.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:r.default.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{type:r.default.Folder,iconType:"svg"},font:{type:r.default.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:r.default.Unknown},html:{extensions:["htm","html","mht"]},link:{type:r.default.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:r.default.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:r.default.OneNote,extensions:["one"]},onetoc:{type:r.default.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},photo:{type:r.default.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:r.default.Folder,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers"]},sysfile:{type:r.default.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:r.default.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:r.default.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:r.default.Unknown,extensions:["zip"]}};t.default=n});define("@ms/odsp-utilities/lib/icons/ItemType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"}(r=t.ItemType||(t.ItemType={}));t.default=r});define("@ms/odsp-utilities/lib/list/SharingTypeHelper",["require","exports","./SharingType"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.usePrivateFolderIcon=function(e){return void 0===e||e===r.default.Private||e===r.default.Unknown};t.showSubTextSharingIcon=function(e){return void 0!==e&&e!==r.default.Private&&e!==r.default.Unknown};t.shouldRequestSharedWithData=function(e){return e!==r.default.Private};t.useSharedFolderAriaLabel=function(e){return e===r.default.Shared}});define("@ms/odsp-utilities/lib/list/SharingType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"}(r||(r={}));t.default=r});define("@ms/odsp-utilities/lib/icons/OfficeFileNameHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n="ms-word",o="onenote|UsePlain",a="ms-powerpoint",i="ms-excel",s="ms-visio",l="ms-publisher",c="ms-access",p="ms-project";t.wordType=n;t.onenoteType=o;t.powerpointType=a;t.excelType=i;t.visioType=s;t.OfficeAppToExtensionsMap={"ms-access":["accdb"],"ms-word":["doc","docm","docx","dot","dotm","dotx","odt"],"ms-project":["mpp"],"onenote|UsePlain":["one","onepkg","onetoc2","notebook"],"ms-powerpoint":["odp","pot","potm","potx","ppa","ppam","pps","ppsm","ppsx","ppt","pptm","pptx"],"ms-publisher":["pub"],"ms-excel":["csv","ods","xla","xlam","xll","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],"ms-visio":["vdw","vsd","vsdm","vsdx","vsl","vss","vssm","vssx","vst","vstm","vstx"]};t.OfficeIconFileTypeMap={accdb:c,csv:i,doc:n,docm:n,docx:n,dot:n,dotm:n,dotx:n,odp:a,ods:i,odt:n,one:o,onepkg:o,onetoc2:o,mpp:p,notebook:o,pot:a,potm:a,potx:a,ppa:a,ppam:a,pps:a,ppsm:a,ppsx:a,ppt:a,pptm:a,pptx:a,pub:l,vdw:s,vsd:s,vsdm:s,vsdx:s,vsl:s,vss:s,vssm:s,vssx:s,vst:s,vstm:s,vstx:s,xla:i,xlam:i,xll:i,xls:i,xlsb:i,xlsm:i,xlsx:i,xlt:i,xltm:i,xltx:i};var u=((r={})[c]="Access",r[n]="Word",r[o]="OneNote",r[a]="PowerPoint",r[i]="Excel",r[s]="Visio",r[l]="Publisher",r[p]="Project",r);t.getOfficeAppFriendlyName=function(e){return u[e]||e}});define("@ms/odsp-utilities/lib/navigation/AddressParser",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deserializeQuery=function(e){var t={};if(e)for(var r=e.split("&"),n=0;n<r.length;n++){var o=r[n].split("=");if(void 0!==o[1]){o[1]=o[1].replace(/\+/g," ");t[o[0]]=decodeURIComponent(o[1])}}return t};t.getQueryStringFromUrl=function(e){return e.substring(e.indexOf("?")+1)};t.getUrlWithoutQueryString=function(e){return e.substring(0,e.indexOf("?"))}});define("@ms/utilities-jwt/lib/claims",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}t.parseTokenHeader=function(e){return e?r(decodeURIComponent(e).split(".")[0]):{}};t.parseTokenPayload=function(e){return e?r(decodeURIComponent(e).split(".")[1]):{}};t.isHashedProofToken=function(e){return!!e&&"hashedprooftoken"===e.ver};t.getAppId=function(e){if(e){var t=e.azp||e.appid;if(t)return t;var r=e.nameid;return r&&"true"!==e.isuser&&r.split("@")[0]||void 0}};t.getTenantId=function(e){if(e){if(e.tid)return e.tid;var t=e.nameid;return t&&t.split("@")[1]||void 0}};t.parseTimestamp=function(e){return isNaN(e)?NaN:1e3*e};t.isTokenValid=function(e,t){void 0===t&&(t=Date.now());var r=t/1e3;if(!e)return!1;var n=e.exp,o=e.nbf;return("number"!=typeof o||o<=r)&&("number"!=typeof n||r<n)}});define("odsp-next/utilities/appId/KnownIds",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["00000002-0000-0ff1-ce00-000000000000","2d4d3d8e-2be3-4bef-9f87-7875a61c29de","00000007-0000-0ff1-ce00-000000000000","cc15fd57-2c6c-4117-a88c-83b1d56b4bbe","5e3ce6c0-2b1f-4285-8d4b-75ee78787346","1fec8e78-bce4-4aaf-ab1b-5451cc387264","3ab4b783-69c8-4af2-b6b3-7bb6d4bcff21","944f0bd1-117b-4b1c-af26-804ed95e767e","4345a7b9-9a63-4910-a426-35363201d503","d3590ed6-52b3-4102-aeff-aad2292ab01c","27922004-5251-4030-b22d-91ecd9a37ea4"],n=["00000005-0000-0ff1-ce00-000000000000","6b4b7fb3-0cd3-406a-85d0-4e4dbb1c4a66","b26aadf8-566f-4478-926f-589f601d9c74","af124e86-4e96-495a-b70a-90f90ab96707","ab9b8c07-8f02-4f72-87fa-80105867a763","80ccca67-54bd-44ab-8625-4b79c4dc7775","d2651b8f-b523-4ffd-a8d2-e91242097cd6","c57a5634-1757-4ea7-a8ea-5ab3a51c8a03","00000009-0000-0000-c000-000000000000"];t.isWopiAllowed=function(e){return!e||0<=r.indexOf(e.toLowerCase())};t.isFirstParty=function(e){if(!e)return!0;var t=e.toLowerCase();return 0<=r.indexOf(t)||0<=n.indexOf(t)}});define("odsp-next/utilities/images/ImagePreloader",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.preloadImage=function(e){var t=document.createElement("link");t.setAttribute("rel","preload");t.setAttribute("as","image");t.href=e;document.head.appendChild(t)}});define("odsp-next/dataSources/item/vroom/EmbedResponseTranslator",["require","exports","tslib","@ms/utilities-objects/lib/assign","@ms/utilities-guid/lib/Guid"],function(e,t,k,U,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I={response:void 0,status:404};t.translateRenderList=function(e,t,r){if(!e)return I;var n=e.ListData.Row[0],o=e.ListSchema;if(!n)return I;var a,i=e.PageContextInfo,s=r||{};if(i)try{a=JSON.parse(i)}catch(e){}a=U.assign(s,k.__assign({},a||{},s));var l=n[".spItemUrl"],c=l.replace(/[?].+$/g,""),p=l.split(/(?:\/(?:drives|items)\/|[?]version=)/gi),u=p[0],d=p[1],f=p[2],m=p[3],v=0<=l.indexOf("/v2.1/"),b=u+"/$metadata",h=n.FileRef.replace(e.listUrlDir,":").replace("/"+n.FileLeafRef,"").replace(/:$/,""),x=o[".thumbnailUrl"].replace(/\{(\.[^\}]+)\}/g,function(e,t){var r=n[t];return r?encodeURIComponent(r):o[t]}),_=Number(n._VirusStatus)||0,g=0!==_&&3!==_?{}:void 0,y=O(n.MediaServiceFastMetadata),w=c+(v?"":"/versions/"+(m||"Published"))+"/streams/content/streamContent?"+o[v?".driveAccessTokenV21":".driveAccessToken"],P={blockDownload:a.blockDownloadsExperienceEnabled,viewOnly:a.viewOnlyExperienceEnabled},S=n["serverurl.progid"];S&&(S=S.slice(1));return{response:k.__assign({"@odata.context":b,"@odata.id":c,"@content.downloadUrl":w,cTag:n[".ctag"],dataLossPrevention:P,eTag:n[".etag"],id:f,malware:g,name:n.FileLeafRef,parentReference:{driveId:d,driveType:"business",path:"/drives/"+d+"/root"+h},size:Number(n.File_x0020_Size),thumbnails:[{large:{url:x}}],webUrl:S},y),status:t}};t.translateFileInfo=function(e,t,r,n){if(200!==t||!e)return{response:void 0,status:t};var o=e[".spItemUrl"],a=o.replace(/[?].+$/g,""),i=o.split(/(?:\/(?:drives|items)\/|[?]version=)/gi),s=i[0],l=i[1],c=i[2],p=s+"/$metadata",u=e.name,d=e.path,f=d.slice(d.indexOf("/")-1);f="/"===f?"":":"+f;var m=e[".transformUrl"].replace("/{.method}?","/thumbnail?"),v=O(e.MediaServiceFastMetadata),b=e.webUrl,h=!/\.pdf$/i.test(u)&&b||r.webAbsoluteUrl+"/_layouts/15/viewer.aspx?sourcedoc="+_.normalizeLower(n),x={blockDownload:r.blockDownloadsExperienceEnabled,viewOnly:r.viewOnlyExperienceEnabled};return{response:k.__assign({"@odata.context":p,"@odata.id":a,"@content.downloadUrl":e.downloadUrl,cTag:e[".ctag"],dataLossPrevention:x,eTag:e[".etag"],id:c,name:e.name,parentReference:{driveId:l,driveType:"business",path:"/drives/"+l+"/root"+f},size:e.size,thumbnails:[{large:{url:m}}],webUrl:h},v),status:200}};function O(e){if(e&&"{}"!==e&&"{"===e[0])try{var t=JSON.parse(e),r=t.media,n=void 0===r?{}:r,o=t.photo,a=t.video;o&&(t.image=o);if(a){var i=n.duration,s=void 0===i?0:i;t.video={fourCC:a.fourCC,bitrate:a.encodingBitrate,width:a.frameWidth||0,height:a.frameHeight||0,manifestMetadata:a.manifestMetadata,duration:s/1e4}}return t}catch(e){}return{}}});define("@ms/utilities-objects/lib/assign",["require","exports","tslib"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assign=function(e,t){return r.__assign(e,t)}});define("@ms/utilities-guid/lib/Guid",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){for(var t="";t.length<e;){var r=16*Math.random();t+=(r|=0).toString(16)}return t}t.Empty="00000000-0000-0000-0000-000000000000";t.generate=function(){var e=[];e.push(o(8));e.push(o(4));var t="4"+o(3);e.push(t);var r=o(4),n=parseInt(r[0],16);n&=3;r=(n|=8).toString(16)+r.substr(1);e.push(r);e.push(o(12));return e.join("-")};t.normalizeLower=function(e,t){void 0===t&&(t=!1);return e?n(e.toLowerCase(),t):""};t.normalizeUpper=function(e,t){void 0===t&&(t=!1);return e?n(e.toUpperCase(),t):""};t.normalizeDashes=function(e,t){void 0===t&&(t=!1);if(e){var r=e.replace(/[^A-Fa-f0-9]/g,"");if(32===r.length)return n(r.slice(0,8)+"-"+r.slice(8,12)+"-"+r.slice(12,16)+"-"+r.slice(16,20)+"-"+r.slice(20),t)}return""};function n(e,t){var r=e.match(/^\{(.*)\}$/);return r?t?r[0]:r[1]:t?"{"+e+"}":e}});define("odsp-next/dataSources/item/vroom/Fetch",["require","exports","tslib"],function(e,t,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createPrefetchResult=function(){return{callback:void 0,correlationId:void 0,data:void 0,status:void 0}};t.prefetchUrl=function(e,t){var r=e.authToken,o=e.isExpired,n=e.postdata,a=e.prefetchResult,i=e.translate,s=e.parseResponse,l=void 0===s?i?function(e,t){return i(JSON.parse(e),t)}:void 0:s,c=(t||{}).xhr,p=void 0===c?XMLHttpRequest:c,u=e.headers,d=e.url;if(r){var f=d.length+r.length<2e3,m=u&&Object.keys(u).some(function(e){return!!e&&"accept"!==e.toLowerCase()});n||m||!f?u=h.__assign({},u||{},{Authorization:"bearer "+r}):d+=(0<=d.indexOf("?")?"&":"?")+"access_token="+r}var v=new p;v.open(n?"POST":"GET",d,!0);if(u)for(var b in u)v.setRequestHeader(b,u[b]);a.status=-1;v.onreadystatechange=function(){if(v.readyState===XMLHttpRequest.DONE){var t=400;try{0!==(t=v.status)||v.responseText||(t=o?401:400)}catch(e){}a.status=t;a.correlationId=v.getResponseHeader("SPRequestGuid")||void 0;if(t<300)try{if(l){var e=l(v.responseText,t),r=e.response,n=e.status;t=n;a.data=r;a.status=n}else a.data=JSON.parse(v.responseText)}catch(e){a.data=void 0;a.status=t=600}a.callback&&a.callback(t)}};v.send(n||void 0)}});